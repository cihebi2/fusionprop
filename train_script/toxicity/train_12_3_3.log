
==================================================
🚀 启动蛋白质语言模型训练框架
==================================================

使用同一GPU进行特征提取和训练
[2025-05-01 22:29:48] [INFO] 实验名称: ESMC+ESM2
[2025-05-01 22:29:48] [INFO] 训练模式: fusion
[2025-05-01 22:29:48] [INFO] 启用的模型: esm2, esmc
[2025-05-01 22:29:48] [INFO] 融合模型类型: default
[2025-05-01 22:29:48] [INFO] 启用的模型: esm2, esmc
[2025-05-01 22:29:48] [INFO] 训练集负样本欠采样比例 (负:正): 1:20
[2025-05-01 22:29:48] [INFO] 开始预热加载特征提取模型，这将确保模型只加载一次...
[2025-05-01 22:29:48] [INFO] 初始化特征管理器...
[2025-05-01 22:29:48] [INFO] 预热加载所有特征提取模型...
[2025-05-01 22:29:48] [INFO] 预热加载所有特征提取模型...
[2025-05-01 22:29:48] [INFO] 预热加载 esm2 模型...
[2025-05-01 22:29:48] [INFO] 加载ESM2模型: /HOME/scz0brz/run/model/esm2_t33_650M_UR50D
[2025-05-01 22:30:25] [INFO] ESM2模型加载成功，设备: cuda:0
[2025-05-01 22:30:25] [INFO] 预热加载 esmc 模型...
[2025-05-01 22:30:25] [INFO] 加载ESM-C模型: esmc_600m
[2025-05-01 22:30:37] [INFO] ESM-C模型加载成功，设备: cuda:0
[2025-05-01 22:30:37] [INFO] 所有特征提取模型加载完成，将在整个训练过程中保持加载状态
[2025-05-01 22:30:38] [INFO] 成功加载训练集阳性数据: csm_toxin_0.7.csv (2402条)
[2025-05-01 22:30:38] [INFO] 成功加载训练集阴性数据: csm_notoxin_0.7.csv (204810条)
[2025-05-01 22:30:38] [INFO] 成功加载测试集阳性数据: filtered_toxin_0.7.csv (199条)
[2025-05-01 22:30:38] [INFO] 成功加载测试集阴性数据: filtered_notoxin_0.7.csv (4413条)
[2025-05-01 22:30:38] [INFO] 合并后训练集大小: 207212
[2025-05-01 22:30:38] [INFO] 合并后测试集大小: 4612
[2025-05-01 22:30:38] [INFO] 训练集统计: {
  "total_count": 207212,
  "target_distribution": {
    "0": 204810,
    "1": 2402
  },
  "seq_length": {
    "min": 11,
    "max": 1024,
    "mean": 341.66028029264714,
    "median": 302.0
  }
}
[2025-05-01 22:30:38] [INFO] 测试集统计: {
  "total_count": 4612,
  "target_distribution": {
    "0": 4413,
    "1": 199
  },
  "seq_length": {
    "min": 11,
    "max": 1023,
    "mean": 365.3365134431917,
    "median": 333.0
  }
}
[2025-05-01 22:30:38] [INFO] 
==================================================
开始训练第 1/5 折
==================================================
[2025-05-01 22:30:38] [INFO]   Fold 1 - 验证集 (不平衡): 41443 条 (阳性: 481, 阴性: 40962)
[2025-05-01 22:30:38] [INFO]   Fold 1 - 训练集池: 165769 条 (阳性: 1921, 阴性: 163848)
[2025-05-01 22:30:38] [INFO]   Fold 1 - 训练集 (平衡, 欠采样比例 1:20): 40341 条 (阳性: 1921, 阴性: 38420)
[2025-05-01 22:30:38] [INFO] 已创建默认融合模型，融合 ['esm2', 'esmc'] 模型特征
[2025-05-02 00:31:48] [INFO] Epoch 1/30 - Train Loss: 0.5239, Val Loss: 0.1405, Val ACCURACY: 0.9879, Val PRECISION: 0.4845, Val RECALL: 0.7131, Val F1: 0.5770, Val MCC: 0.5820, Val AUC: 0.9839, Val PR_AUC: 0.6544, Val TN: 40597.0000, Val FP: 365.0000, Val FN: 138.0000, Val TP: 343.0000
[2025-05-02 00:31:49] [INFO] ✅ 新的最佳模型! MCC: 0.5820
[2025-05-02 02:32:34] [INFO] Epoch 2/30 - Train Loss: 0.3685, Val Loss: 0.0975, Val ACCURACY: 0.9860, Val PRECISION: 0.4448, Val RECALL: 0.8212, Val F1: 0.5771, Val MCC: 0.5985, Val AUC: 0.9901, Val PR_AUC: 0.7265, Val TN: 40469.0000, Val FP: 493.0000, Val FN: 86.0000, Val TP: 395.0000
[2025-05-02 02:32:35] [INFO] ✅ 新的最佳模型! MCC: 0.5985
[2025-05-02 04:32:10] [INFO] Epoch 3/30 - Train Loss: 0.3208, Val Loss: 0.0957, Val ACCURACY: 0.9897, Val PRECISION: 0.5376, Val RECALL: 0.8025, Val F1: 0.6439, Val MCC: 0.6521, Val AUC: 0.9907, Val PR_AUC: 0.7235, Val TN: 40630.0000, Val FP: 332.0000, Val FN: 95.0000, Val TP: 386.0000
[2025-05-02 04:32:10] [INFO] ✅ 新的最佳模型! MCC: 0.6521
[2025-05-02 06:31:26] [INFO] Epoch 4/30 - Train Loss: 0.2918, Val Loss: 0.0987, Val ACCURACY: 0.9892, Val PRECISION: 0.5215, Val RECALL: 0.8337, Val F1: 0.6416, Val MCC: 0.6545, Val AUC: 0.9901, Val PR_AUC: 0.7511, Val TN: 40594.0000, Val FP: 368.0000, Val FN: 80.0000, Val TP: 401.0000
[2025-05-02 06:31:27] [INFO] ✅ 新的最佳模型! MCC: 0.6545
[2025-05-02 08:30:46] [INFO] Epoch 5/30 - Train Loss: 0.2591, Val Loss: 0.0926, Val ACCURACY: 0.9900, Val PRECISION: 0.5462, Val RECALL: 0.8233, Val F1: 0.6567, Val MCC: 0.6660, Val AUC: 0.9916, Val PR_AUC: 0.7751, Val TN: 40633.0000, Val FP: 329.0000, Val FN: 85.0000, Val TP: 396.0000
[2025-05-02 08:30:47] [INFO] ✅ 新的最佳模型! MCC: 0.6660
[2025-05-02 10:30:09] [INFO] Epoch 6/30 - Train Loss: 0.2388, Val Loss: 0.0910, Val ACCURACY: 0.9902, Val PRECISION: 0.5501, Val RECALL: 0.8337, Val F1: 0.6628, Val MCC: 0.6727, Val AUC: 0.9914, Val PR_AUC: 0.7784, Val TN: 40634.0000, Val FP: 328.0000, Val FN: 80.0000, Val TP: 401.0000
[2025-05-02 10:30:11] [INFO] ✅ 新的最佳模型! MCC: 0.6727
[2025-05-02 12:29:30] [INFO] Epoch 7/30 - Train Loss: 0.2202, Val Loss: 0.0976, Val ACCURACY: 0.9927, Val PRECISION: 0.6535, Val RECALL: 0.7921, Val F1: 0.7162, Val MCC: 0.7159, Val AUC: 0.9912, Val PR_AUC: 0.7879, Val TN: 40760.0000, Val FP: 202.0000, Val FN: 100.0000, Val TP: 381.0000
[2025-05-02 12:29:31] [INFO] ✅ 新的最佳模型! MCC: 0.7159
[2025-05-02 14:28:29] [INFO] Epoch 8/30 - Train Loss: 0.2105, Val Loss: 0.1182, Val ACCURACY: 0.9931, Val PRECISION: 0.6690, Val RECALL: 0.8025, Val F1: 0.7297, Val MCC: 0.7293, Val AUC: 0.9911, Val PR_AUC: 0.7861, Val TN: 40771.0000, Val FP: 191.0000, Val FN: 95.0000, Val TP: 386.0000
[2025-05-02 14:28:29] [INFO] ✅ 新的最佳模型! MCC: 0.7293
[2025-05-02 16:27:24] [INFO] Epoch 9/30 - Train Loss: 0.2029, Val Loss: 0.0966, Val ACCURACY: 0.9883, Val PRECISION: 0.4988, Val RECALL: 0.8919, Val F1: 0.6398, Val MCC: 0.6622, Val AUC: 0.9912, Val PR_AUC: 0.7822, Val TN: 40531.0000, Val FP: 431.0000, Val FN: 52.0000, Val TP: 429.0000
[2025-05-02 18:26:28] [INFO] Epoch 10/30 - Train Loss: 0.1855, Val Loss: 0.0904, Val ACCURACY: 0.9900, Val PRECISION: 0.5415, Val RECALL: 0.8815, Val F1: 0.6709, Val MCC: 0.6866, Val AUC: 0.9913, Val PR_AUC: 0.8004, Val TN: 40603.0000, Val FP: 359.0000, Val FN: 57.0000, Val TP: 424.0000
[2025-05-02 20:25:32] [INFO] Epoch 11/30 - Train Loss: 0.1854, Val Loss: 0.0973, Val ACCURACY: 0.9902, Val PRECISION: 0.5495, Val RECALL: 0.8649, Val F1: 0.6721, Val MCC: 0.6851, Val AUC: 0.9913, Val PR_AUC: 0.7913, Val TN: 40621.0000, Val FP: 341.0000, Val FN: 65.0000, Val TP: 416.0000
[2025-05-02 22:24:29] [INFO] Epoch 12/30 - Train Loss: 0.1772, Val Loss: 0.1088, Val ACCURACY: 0.9919, Val PRECISION: 0.6106, Val RECALL: 0.8378, Val F1: 0.7064, Val MCC: 0.7115, Val AUC: 0.9902, Val PR_AUC: 0.7796, Val TN: 40705.0000, Val FP: 257.0000, Val FN: 78.0000, Val TP: 403.0000
[2025-05-03 00:23:32] [INFO] Epoch 13/30 - Train Loss: 0.1668, Val Loss: 0.0932, Val ACCURACY: 0.9898, Val PRECISION: 0.5358, Val RECALL: 0.8857, Val F1: 0.6677, Val MCC: 0.6845, Val AUC: 0.9899, Val PR_AUC: 0.7897, Val TN: 40593.0000, Val FP: 369.0000, Val FN: 55.0000, Val TP: 426.0000
[2025-05-03 02:22:44] [INFO] Epoch 14/30 - Train Loss: 0.1634, Val Loss: 0.1087, Val ACCURACY: 0.9923, Val PRECISION: 0.6244, Val RECALL: 0.8399, Val F1: 0.7163, Val MCC: 0.7205, Val AUC: 0.9902, Val PR_AUC: 0.7983, Val TN: 40719.0000, Val FP: 243.0000, Val FN: 77.0000, Val TP: 404.0000
[2025-05-03 04:21:54] [INFO] Epoch 15/30 - Train Loss: 0.1566, Val Loss: 0.1160, Val ACCURACY: 0.9926, Val PRECISION: 0.6437, Val RECALL: 0.8150, Val F1: 0.7193, Val MCC: 0.7207, Val AUC: 0.9896, Val PR_AUC: 0.7988, Val TN: 40745.0000, Val FP: 217.0000, Val FN: 89.0000, Val TP: 392.0000
[2025-05-03 06:21:05] [INFO] Epoch 16/30 - Train Loss: 0.1470, Val Loss: 0.1059, Val ACCURACY: 0.9905, Val PRECISION: 0.5578, Val RECALL: 0.8732, Val F1: 0.6807, Val MCC: 0.6937, Val AUC: 0.9898, Val PR_AUC: 0.7940, Val TN: 40629.0000, Val FP: 333.0000, Val FN: 61.0000, Val TP: 420.0000
[2025-05-03 08:20:17] [INFO] Epoch 17/30 - Train Loss: 0.1471, Val Loss: 0.1029, Val ACCURACY: 0.9919, Val PRECISION: 0.6068, Val RECALL: 0.8565, Val F1: 0.7103, Val MCC: 0.7172, Val AUC: 0.9889, Val PR_AUC: 0.7901, Val TN: 40695.0000, Val FP: 267.0000, Val FN: 69.0000, Val TP: 412.0000
[2025-05-03 10:19:07] [INFO] Epoch 18/30 - Train Loss: 0.1387, Val Loss: 0.1177, Val ACCURACY: 0.9919, Val PRECISION: 0.6093, Val RECALL: 0.8462, Val F1: 0.7084, Val MCC: 0.7142, Val AUC: 0.9897, Val PR_AUC: 0.7969, Val TN: 40701.0000, Val FP: 261.0000, Val FN: 74.0000, Val TP: 407.0000
[2025-05-03 10:19:07] [INFO] 早停触发! 10 轮没有改善.
[2025-05-03 10:26:04] [INFO] 
==================================================
开始训练第 2/5 折
==================================================
[2025-05-03 10:26:04] [INFO]   Fold 2 - 验证集 (不平衡): 41443 条 (阳性: 481, 阴性: 40962)
[2025-05-03 10:26:04] [INFO]   Fold 2 - 训练集池: 165769 条 (阳性: 1921, 阴性: 163848)
[2025-05-03 10:26:05] [INFO]   Fold 2 - 训练集 (平衡, 欠采样比例 1:20): 40341 条 (阳性: 1921, 阴性: 38420)
[2025-05-03 10:26:05] [INFO] 已创建默认融合模型，融合 ['esm2', 'esmc'] 模型特征
[2025-05-03 12:25:07] [INFO] Epoch 1/30 - Train Loss: 0.5280, Val Loss: 0.1275, Val ACCURACY: 0.9861, Val PRECISION: 0.4431, Val RECALL: 0.7859, Val F1: 0.5667, Val MCC: 0.5841, Val AUC: 0.9793, Val PR_AUC: 0.6538, Val TN: 40487.0000, Val FP: 475.0000, Val FN: 103.0000, Val TP: 378.0000
[2025-05-03 12:25:07] [INFO] ✅ 新的最佳模型! MCC: 0.5841
[2025-05-03 14:24:04] [INFO] Epoch 2/30 - Train Loss: 0.3594, Val Loss: 0.1168, Val ACCURACY: 0.9899, Val PRECISION: 0.5478, Val RECALL: 0.7630, Val F1: 0.6377, Val MCC: 0.6417, Val AUC: 0.9851, Val PR_AUC: 0.7065, Val TN: 40659.0000, Val FP: 303.0000, Val FN: 114.0000, Val TP: 367.0000
[2025-05-03 14:24:05] [INFO] ✅ 新的最佳模型! MCC: 0.6417
[2025-05-03 16:23:08] [INFO] Epoch 3/30 - Train Loss: 0.3175, Val Loss: 0.1256, Val ACCURACY: 0.9812, Val PRECISION: 0.3692, Val RECALL: 0.8773, Val F1: 0.5197, Val MCC: 0.5623, Val AUC: 0.9873, Val PR_AUC: 0.7333, Val TN: 40241.0000, Val FP: 721.0000, Val FN: 59.0000, Val TP: 422.0000
[2025-05-03 18:22:11] [INFO] Epoch 4/30 - Train Loss: 0.2711, Val Loss: 0.1004, Val ACCURACY: 0.9880, Val PRECISION: 0.4893, Val RECALL: 0.8586, Val F1: 0.6234, Val MCC: 0.6431, Val AUC: 0.9885, Val PR_AUC: 0.7519, Val TN: 40531.0000, Val FP: 431.0000, Val FN: 68.0000, Val TP: 413.0000
[2025-05-03 18:22:11] [INFO] ✅ 新的最佳模型! MCC: 0.6431
[2025-05-03 20:21:15] [INFO] Epoch 5/30 - Train Loss: 0.2492, Val Loss: 0.1014, Val ACCURACY: 0.9857, Val PRECISION: 0.4425, Val RECALL: 0.8960, Val F1: 0.5924, Val MCC: 0.6241, Val AUC: 0.9893, Val PR_AUC: 0.7678, Val TN: 40419.0000, Val FP: 543.0000, Val FN: 50.0000, Val TP: 431.0000
[2025-05-03 22:20:07] [INFO] Epoch 6/30 - Train Loss: 0.2307, Val Loss: 0.0861, Val ACCURACY: 0.9881, Val PRECISION: 0.4925, Val RECALL: 0.8836, Val F1: 0.6324, Val MCC: 0.6547, Val AUC: 0.9893, Val PR_AUC: 0.7914, Val TN: 40524.0000, Val FP: 438.0000, Val FN: 56.0000, Val TP: 425.0000
[2025-05-03 22:20:08] [INFO] ✅ 新的最佳模型! MCC: 0.6547
[2025-05-04 00:18:54] [INFO] Epoch 7/30 - Train Loss: 0.2149, Val Loss: 0.0974, Val ACCURACY: 0.9852, Val PRECISION: 0.4350, Val RECALL: 0.9314, Val F1: 0.5930, Val MCC: 0.6310, Val AUC: 0.9895, Val PR_AUC: 0.7886, Val TN: 40380.0000, Val FP: 582.0000, Val FN: 33.0000, Val TP: 448.0000
[2025-05-04 02:17:44] [INFO] Epoch 8/30 - Train Loss: 0.2122, Val Loss: 0.1173, Val ACCURACY: 0.9802, Val PRECISION: 0.3635, Val RECALL: 0.9439, Val F1: 0.5249, Val MCC: 0.5791, Val AUC: 0.9893, Val PR_AUC: 0.7576, Val TN: 40167.0000, Val FP: 795.0000, Val FN: 27.0000, Val TP: 454.0000
[2025-05-04 04:16:37] [INFO] Epoch 9/30 - Train Loss: 0.1982, Val Loss: 0.0945, Val ACCURACY: 0.9901, Val PRECISION: 0.5464, Val RECALL: 0.8815, Val F1: 0.6746, Val MCC: 0.6897, Val AUC: 0.9896, Val PR_AUC: 0.7926, Val TN: 40610.0000, Val FP: 352.0000, Val FN: 57.0000, Val TP: 424.0000
[2025-05-04 04:16:38] [INFO] ✅ 新的最佳模型! MCC: 0.6897
[2025-05-04 06:15:40] [INFO] Epoch 10/30 - Train Loss: 0.1910, Val Loss: 0.0919, Val ACCURACY: 0.9932, Val PRECISION: 0.6667, Val RECALL: 0.8316, Val F1: 0.7401, Val MCC: 0.7413, Val AUC: 0.9897, Val PR_AUC: 0.7799, Val TN: 40762.0000, Val FP: 200.0000, Val FN: 81.0000, Val TP: 400.0000
[2025-05-04 06:15:40] [INFO] ✅ 新的最佳模型! MCC: 0.7413
[2025-05-04 08:14:46] [INFO] Epoch 11/30 - Train Loss: 0.1797, Val Loss: 0.0883, Val ACCURACY: 0.9894, Val PRECISION: 0.5243, Val RECALL: 0.8960, Val F1: 0.6616, Val MCC: 0.6810, Val AUC: 0.9898, Val PR_AUC: 0.7979, Val TN: 40571.0000, Val FP: 391.0000, Val FN: 50.0000, Val TP: 431.0000
[2025-05-04 10:13:51] [INFO] Epoch 12/30 - Train Loss: 0.1824, Val Loss: 0.0801, Val ACCURACY: 0.9928, Val PRECISION: 0.6382, Val RECALL: 0.8690, Val F1: 0.7359, Val MCC: 0.7413, Val AUC: 0.9891, Val PR_AUC: 0.8070, Val TN: 40725.0000, Val FP: 237.0000, Val FN: 63.0000, Val TP: 418.0000
[2025-05-04 10:13:51] [INFO] ✅ 新的最佳模型! MCC: 0.7413
[2025-05-04 12:13:04] [INFO] Epoch 13/30 - Train Loss: 0.1747, Val Loss: 0.0999, Val ACCURACY: 0.9867, Val PRECISION: 0.4638, Val RECALL: 0.9459, Val F1: 0.6224, Val MCC: 0.6574, Val AUC: 0.9901, Val PR_AUC: 0.8065, Val TN: 40436.0000, Val FP: 526.0000, Val FN: 26.0000, Val TP: 455.0000
[2025-05-04 14:12:16] [INFO] Epoch 14/30 - Train Loss: 0.1613, Val Loss: 0.0876, Val ACCURACY: 0.9907, Val PRECISION: 0.5614, Val RECALL: 0.9023, Val F1: 0.6922, Val MCC: 0.7077, Val AUC: 0.9897, Val PR_AUC: 0.8102, Val TN: 40623.0000, Val FP: 339.0000, Val FN: 47.0000, Val TP: 434.0000
[2025-05-04 16:11:29] [INFO] Epoch 15/30 - Train Loss: 0.1533, Val Loss: 0.0861, Val ACCURACY: 0.9917, Val PRECISION: 0.5975, Val RECALL: 0.8857, Val F1: 0.7136, Val MCC: 0.7237, Val AUC: 0.9902, Val PR_AUC: 0.8065, Val TN: 40675.0000, Val FP: 287.0000, Val FN: 55.0000, Val TP: 426.0000
[2025-05-04 18:10:43] [INFO] Epoch 16/30 - Train Loss: 0.1541, Val Loss: 0.0919, Val ACCURACY: 0.9900, Val PRECISION: 0.5405, Val RECALL: 0.9023, Val F1: 0.6760, Val MCC: 0.6941, Val AUC: 0.9891, Val PR_AUC: 0.8181, Val TN: 40593.0000, Val FP: 369.0000, Val FN: 47.0000, Val TP: 434.0000
[2025-05-04 20:10:03] [INFO] Epoch 17/30 - Train Loss: 0.1405, Val Loss: 0.0942, Val ACCURACY: 0.9913, Val PRECISION: 0.5832, Val RECALL: 0.8815, Val F1: 0.7020, Val MCC: 0.7131, Val AUC: 0.9889, Val PR_AUC: 0.8185, Val TN: 40659.0000, Val FP: 303.0000, Val FN: 57.0000, Val TP: 424.0000
[2025-05-04 22:09:09] [INFO] Epoch 18/30 - Train Loss: 0.1384, Val Loss: 0.0931, Val ACCURACY: 0.9917, Val PRECISION: 0.5947, Val RECALL: 0.8877, Val F1: 0.7123, Val MCC: 0.7229, Val AUC: 0.9895, Val PR_AUC: 0.8209, Val TN: 40671.0000, Val FP: 291.0000, Val FN: 54.0000, Val TP: 427.0000
[2025-05-05 00:08:25] [INFO] Epoch 19/30 - Train Loss: 0.1304, Val Loss: 0.0970, Val ACCURACY: 0.9914, Val PRECISION: 0.5851, Val RECALL: 0.9002, Val F1: 0.7093, Val MCC: 0.7220, Val AUC: 0.9889, Val PR_AUC: 0.8164, Val TN: 40655.0000, Val FP: 307.0000, Val FN: 48.0000, Val TP: 433.0000
[2025-05-05 02:07:38] [INFO] Epoch 20/30 - Train Loss: 0.1329, Val Loss: 0.0974, Val ACCURACY: 0.9912, Val PRECISION: 0.5777, Val RECALL: 0.9044, Val F1: 0.7050, Val MCC: 0.7190, Val AUC: 0.9879, Val PR_AUC: 0.8168, Val TN: 40644.0000, Val FP: 318.0000, Val FN: 46.0000, Val TP: 435.0000
[2025-05-05 04:07:01] [INFO] Epoch 21/30 - Train Loss: 0.1222, Val Loss: 0.0993, Val ACCURACY: 0.9911, Val PRECISION: 0.5724, Val RECALL: 0.9127, Val F1: 0.7035, Val MCC: 0.7189, Val AUC: 0.9885, Val PR_AUC: 0.8188, Val TN: 40634.0000, Val FP: 328.0000, Val FN: 42.0000, Val TP: 439.0000
[2025-05-05 06:06:18] [INFO] Epoch 22/30 - Train Loss: 0.1134, Val Loss: 0.0952, Val ACCURACY: 0.9922, Val PRECISION: 0.6123, Val RECALL: 0.8898, Val F1: 0.7254, Val MCC: 0.7346, Val AUC: 0.9878, Val PR_AUC: 0.8202, Val TN: 40691.0000, Val FP: 271.0000, Val FN: 53.0000, Val TP: 428.0000
[2025-05-05 06:06:18] [INFO] 早停触发! 10 轮没有改善.
[2025-05-05 06:13:16] [INFO] 
==================================================
开始训练第 3/5 折
==================================================
[2025-05-05 06:13:17] [INFO]   Fold 3 - 验证集 (不平衡): 41442 条 (阳性: 480, 阴性: 40962)
[2025-05-05 06:13:17] [INFO]   Fold 3 - 训练集池: 165770 条 (阳性: 1922, 阴性: 163848)
[2025-05-05 06:13:17] [INFO]   Fold 3 - 训练集 (平衡, 欠采样比例 1:20): 40362 条 (阳性: 1922, 阴性: 38440)
[2025-05-05 06:13:17] [INFO] 已创建默认融合模型，融合 ['esm2', 'esmc'] 模型特征
[2025-05-05 08:12:50] [INFO] Epoch 1/30 - Train Loss: 0.5024, Val Loss: 0.1305, Val ACCURACY: 0.9862, Val PRECISION: 0.4443, Val RECALL: 0.7646, Val F1: 0.5620, Val MCC: 0.5767, Val AUC: 0.9825, Val PR_AUC: 0.6711, Val TN: 40503.0000, Val FP: 459.0000, Val FN: 113.0000, Val TP: 367.0000
[2025-05-05 08:12:50] [INFO] ✅ 新的最佳模型! MCC: 0.5767
[2025-05-05 10:12:26] [INFO] Epoch 2/30 - Train Loss: 0.3759, Val Loss: 0.1114, Val ACCURACY: 0.9900, Val PRECISION: 0.5498, Val RECALL: 0.7708, Val F1: 0.6418, Val MCC: 0.6463, Val AUC: 0.9892, Val PR_AUC: 0.7389, Val TN: 40659.0000, Val FP: 303.0000, Val FN: 110.0000, Val TP: 370.0000
[2025-05-05 10:12:26] [INFO] ✅ 新的最佳模型! MCC: 0.6463
[2025-05-05 12:11:59] [INFO] Epoch 3/30 - Train Loss: 0.3171, Val Loss: 0.0901, Val ACCURACY: 0.9903, Val PRECISION: 0.5585, Val RECALL: 0.7958, Val F1: 0.6564, Val MCC: 0.6622, Val AUC: 0.9906, Val PR_AUC: 0.7512, Val TN: 40660.0000, Val FP: 302.0000, Val FN: 98.0000, Val TP: 382.0000
[2025-05-05 12:11:59] [INFO] ✅ 新的最佳模型! MCC: 0.6622
[2025-05-05 14:11:25] [INFO] Epoch 4/30 - Train Loss: 0.2846, Val Loss: 0.0954, Val ACCURACY: 0.9897, Val PRECISION: 0.5376, Val RECALL: 0.8187, Val F1: 0.6491, Val MCC: 0.6588, Val AUC: 0.9916, Val PR_AUC: 0.7709, Val TN: 40624.0000, Val FP: 338.0000, Val FN: 87.0000, Val TP: 393.0000
[2025-05-05 16:10:46] [INFO] Epoch 5/30 - Train Loss: 0.2577, Val Loss: 0.0848, Val ACCURACY: 0.9891, Val PRECISION: 0.5181, Val RECALL: 0.8646, Val F1: 0.6479, Val MCC: 0.6646, Val AUC: 0.9916, Val PR_AUC: 0.7778, Val TN: 40576.0000, Val FP: 386.0000, Val FN: 65.0000, Val TP: 415.0000
[2025-05-05 16:10:47] [INFO] ✅ 新的最佳模型! MCC: 0.6646
[2025-05-05 18:10:11] [INFO] Epoch 6/30 - Train Loss: 0.2340, Val Loss: 0.0781, Val ACCURACY: 0.9927, Val PRECISION: 0.6530, Val RECALL: 0.7958, Val F1: 0.7174, Val MCC: 0.7173, Val AUC: 0.9922, Val PR_AUC: 0.8005, Val TN: 40759.0000, Val FP: 203.0000, Val FN: 98.0000, Val TP: 382.0000
[2025-05-05 18:10:11] [INFO] ✅ 新的最佳模型! MCC: 0.7173
[2025-05-05 20:09:30] [INFO] Epoch 7/30 - Train Loss: 0.2287, Val Loss: 0.0754, Val ACCURACY: 0.9908, Val PRECISION: 0.5668, Val RECALL: 0.8667, Val F1: 0.6853, Val MCC: 0.6967, Val AUC: 0.9925, Val PR_AUC: 0.7997, Val TN: 40644.0000, Val FP: 318.0000, Val FN: 64.0000, Val TP: 416.0000
[2025-05-05 22:08:39] [INFO] Epoch 8/30 - Train Loss: 0.2151, Val Loss: 0.0736, Val ACCURACY: 0.9910, Val PRECISION: 0.5707, Val RECALL: 0.8833, Val F1: 0.6934, Val MCC: 0.7060, Val AUC: 0.9924, Val PR_AUC: 0.7997, Val TN: 40643.0000, Val FP: 319.0000, Val FN: 56.0000, Val TP: 424.0000
[2025-05-06 00:07:52] [INFO] Epoch 9/30 - Train Loss: 0.2052, Val Loss: 0.0832, Val ACCURACY: 0.9923, Val PRECISION: 0.6262, Val RECALL: 0.8271, Val F1: 0.7127, Val MCC: 0.7160, Val AUC: 0.9921, Val PR_AUC: 0.8005, Val TN: 40725.0000, Val FP: 237.0000, Val FN: 83.0000, Val TP: 397.0000
[2025-05-06 02:07:04] [INFO] Epoch 10/30 - Train Loss: 0.2007, Val Loss: 0.0805, Val ACCURACY: 0.9922, Val PRECISION: 0.6234, Val RECALL: 0.8313, Val F1: 0.7125, Val MCC: 0.7162, Val AUC: 0.9918, Val PR_AUC: 0.8020, Val TN: 40721.0000, Val FP: 241.0000, Val FN: 81.0000, Val TP: 399.0000
[2025-05-06 04:06:27] [INFO] Epoch 11/30 - Train Loss: 0.1890, Val Loss: 0.0773, Val ACCURACY: 0.9920, Val PRECISION: 0.6113, Val RECALL: 0.8583, Val F1: 0.7140, Val MCC: 0.7207, Val AUC: 0.9925, Val PR_AUC: 0.8170, Val TN: 40700.0000, Val FP: 262.0000, Val FN: 68.0000, Val TP: 412.0000
[2025-05-06 04:06:27] [INFO] ✅ 新的最佳模型! MCC: 0.7207
[2025-05-06 06:05:40] [INFO] Epoch 12/30 - Train Loss: 0.1826, Val Loss: 0.0837, Val ACCURACY: 0.9922, Val PRECISION: 0.6179, Val RECALL: 0.8625, Val F1: 0.7200, Val MCC: 0.7264, Val AUC: 0.9923, Val PR_AUC: 0.8066, Val TN: 40706.0000, Val FP: 256.0000, Val FN: 66.0000, Val TP: 414.0000
[2025-05-06 06:05:40] [INFO] ✅ 新的最佳模型! MCC: 0.7264
[2025-05-06 08:04:54] [INFO] Epoch 13/30 - Train Loss: 0.1689, Val Loss: 0.0766, Val ACCURACY: 0.9917, Val PRECISION: 0.5952, Val RECALL: 0.8792, Val F1: 0.7098, Val MCC: 0.7196, Val AUC: 0.9921, Val PR_AUC: 0.8095, Val TN: 40675.0000, Val FP: 287.0000, Val FN: 58.0000, Val TP: 422.0000
[2025-05-06 10:04:17] [INFO] Epoch 14/30 - Train Loss: 0.1708, Val Loss: 0.0903, Val ACCURACY: 0.9939, Val PRECISION: 0.6995, Val RECALL: 0.8292, Val F1: 0.7588, Val MCC: 0.7586, Val AUC: 0.9925, Val PR_AUC: 0.8199, Val TN: 40791.0000, Val FP: 171.0000, Val FN: 82.0000, Val TP: 398.0000
[2025-05-06 10:04:17] [INFO] ✅ 新的最佳模型! MCC: 0.7586
[2025-05-06 12:03:58] [INFO] Epoch 15/30 - Train Loss: 0.1623, Val Loss: 0.0796, Val ACCURACY: 0.9916, Val PRECISION: 0.5915, Val RECALL: 0.8750, Val F1: 0.7059, Val MCC: 0.7156, Val AUC: 0.9923, Val PR_AUC: 0.8216, Val TN: 40672.0000, Val FP: 290.0000, Val FN: 60.0000, Val TP: 420.0000
[2025-05-06 14:03:26] [INFO] Epoch 16/30 - Train Loss: 0.1602, Val Loss: 0.0802, Val ACCURACY: 0.9922, Val PRECISION: 0.6134, Val RECALL: 0.8792, Val F1: 0.7226, Val MCC: 0.7308, Val AUC: 0.9924, Val PR_AUC: 0.8248, Val TN: 40696.0000, Val FP: 266.0000, Val FN: 58.0000, Val TP: 422.0000
[2025-05-06 16:02:49] [INFO] Epoch 17/30 - Train Loss: 0.1498, Val Loss: 0.0821, Val ACCURACY: 0.9925, Val PRECISION: 0.6286, Val RECALL: 0.8708, Val F1: 0.7301, Val MCC: 0.7364, Val AUC: 0.9921, Val PR_AUC: 0.8203, Val TN: 40715.0000, Val FP: 247.0000, Val FN: 62.0000, Val TP: 418.0000
[2025-05-06 18:02:11] [INFO] Epoch 18/30 - Train Loss: 0.1365, Val Loss: 0.0852, Val ACCURACY: 0.9919, Val PRECISION: 0.6020, Val RECALL: 0.8854, Val F1: 0.7167, Val MCC: 0.7264, Val AUC: 0.9922, Val PR_AUC: 0.8193, Val TN: 40681.0000, Val FP: 281.0000, Val FN: 55.0000, Val TP: 425.0000
[2025-05-06 20:01:28] [INFO] Epoch 19/30 - Train Loss: 0.1437, Val Loss: 0.0841, Val ACCURACY: 0.9903, Val PRECISION: 0.5483, Val RECALL: 0.8979, Val F1: 0.6809, Val MCC: 0.6975, Val AUC: 0.9920, Val PR_AUC: 0.8090, Val TN: 40607.0000, Val FP: 355.0000, Val FN: 49.0000, Val TP: 431.0000
[2025-05-06 22:00:31] [INFO] Epoch 20/30 - Train Loss: 0.1340, Val Loss: 0.0868, Val ACCURACY: 0.9920, Val PRECISION: 0.6060, Val RECALL: 0.8875, Val F1: 0.7202, Val MCC: 0.7298, Val AUC: 0.9920, Val PR_AUC: 0.8234, Val TN: 40685.0000, Val FP: 277.0000, Val FN: 54.0000, Val TP: 426.0000
[2025-05-06 23:59:36] [INFO] Epoch 21/30 - Train Loss: 0.1312, Val Loss: 0.0905, Val ACCURACY: 0.9920, Val PRECISION: 0.6072, Val RECALL: 0.8729, Val F1: 0.7162, Val MCC: 0.7244, Val AUC: 0.9916, Val PR_AUC: 0.8202, Val TN: 40691.0000, Val FP: 271.0000, Val FN: 61.0000, Val TP: 419.0000
[2025-05-07 01:58:49] [INFO] Epoch 22/30 - Train Loss: 0.1213, Val Loss: 0.0942, Val ACCURACY: 0.9925, Val PRECISION: 0.6243, Val RECALL: 0.8792, Val F1: 0.7301, Val MCC: 0.7374, Val AUC: 0.9922, Val PR_AUC: 0.8258, Val TN: 40708.0000, Val FP: 254.0000, Val FN: 58.0000, Val TP: 422.0000
[2025-05-07 03:58:16] [INFO] Epoch 23/30 - Train Loss: 0.1250, Val Loss: 0.0898, Val ACCURACY: 0.9914, Val PRECISION: 0.5845, Val RECALL: 0.8938, Val F1: 0.7068, Val MCC: 0.7190, Val AUC: 0.9919, Val PR_AUC: 0.8227, Val TN: 40657.0000, Val FP: 305.0000, Val FN: 51.0000, Val TP: 429.0000
[2025-05-07 05:57:47] [INFO] Epoch 24/30 - Train Loss: 0.1196, Val Loss: 0.0947, Val ACCURACY: 0.9927, Val PRECISION: 0.6361, Val RECALL: 0.8667, Val F1: 0.7337, Val MCC: 0.7391, Val AUC: 0.9917, Val PR_AUC: 0.8231, Val TN: 40724.0000, Val FP: 238.0000, Val FN: 64.0000, Val TP: 416.0000
[2025-05-07 05:57:47] [INFO] 早停触发! 10 轮没有改善.
[2025-05-07 06:04:44] [INFO] 
==================================================
开始训练第 4/5 折
==================================================
[2025-05-07 06:04:44] [INFO]   Fold 4 - 验证集 (不平衡): 41442 条 (阳性: 480, 阴性: 40962)
[2025-05-07 06:04:44] [INFO]   Fold 4 - 训练集池: 165770 条 (阳性: 1922, 阴性: 163848)
[2025-05-07 06:04:45] [INFO]   Fold 4 - 训练集 (平衡, 欠采样比例 1:20): 40362 条 (阳性: 1922, 阴性: 38440)
[2025-05-07 06:04:45] [INFO] 已创建默认融合模型，融合 ['esm2', 'esmc'] 模型特征
[2025-05-07 08:04:23] [INFO] Epoch 1/30 - Train Loss: 0.5306, Val Loss: 0.1343, Val ACCURACY: 0.9894, Val PRECISION: 0.5315, Val RECALL: 0.7021, Val F1: 0.6050, Val MCC: 0.6057, Val AUC: 0.9860, Val PR_AUC: 0.6765, Val TN: 40665.0000, Val FP: 297.0000, Val FN: 143.0000, Val TP: 337.0000
[2025-05-07 08:04:23] [INFO] ✅ 新的最佳模型! MCC: 0.6057
[2025-05-07 10:04:04] [INFO] Epoch 2/30 - Train Loss: 0.3647, Val Loss: 0.1186, Val ACCURACY: 0.9896, Val PRECISION: 0.5376, Val RECALL: 0.7604, Val F1: 0.6299, Val MCC: 0.6344, Val AUC: 0.9886, Val PR_AUC: 0.7348, Val TN: 40648.0000, Val FP: 314.0000, Val FN: 115.0000, Val TP: 365.0000
[2025-05-07 10:04:04] [INFO] ✅ 新的最佳模型! MCC: 0.6344
[2025-05-07 12:03:30] [INFO] Epoch 3/30 - Train Loss: 0.3090, Val Loss: 0.0950, Val ACCURACY: 0.9903, Val PRECISION: 0.5583, Val RECALL: 0.7875, Val F1: 0.6534, Val MCC: 0.6585, Val AUC: 0.9911, Val PR_AUC: 0.7596, Val TN: 40663.0000, Val FP: 299.0000, Val FN: 102.0000, Val TP: 378.0000
[2025-05-07 12:03:30] [INFO] ✅ 新的最佳模型! MCC: 0.6585
[2025-05-07 14:02:43] [INFO] Epoch 4/30 - Train Loss: 0.2724, Val Loss: 0.0974, Val ACCURACY: 0.9875, Val PRECISION: 0.4760, Val RECALL: 0.8271, Val F1: 0.6043, Val MCC: 0.6221, Val AUC: 0.9899, Val PR_AUC: 0.7640, Val TN: 40525.0000, Val FP: 437.0000, Val FN: 83.0000, Val TP: 397.0000
[2025-05-07 16:02:09] [INFO] Epoch 5/30 - Train Loss: 0.2457, Val Loss: 0.0939, Val ACCURACY: 0.9896, Val PRECISION: 0.5341, Val RECALL: 0.8167, Val F1: 0.6458, Val MCC: 0.6557, Val AUC: 0.9915, Val PR_AUC: 0.7833, Val TN: 40620.0000, Val FP: 342.0000, Val FN: 88.0000, Val TP: 392.0000
[2025-05-07 18:01:34] [INFO] Epoch 6/30 - Train Loss: 0.2416, Val Loss: 0.1287, Val ACCURACY: 0.9938, Val PRECISION: 0.7368, Val RECALL: 0.7292, Val F1: 0.7330, Val MCC: 0.7299, Val AUC: 0.9925, Val PR_AUC: 0.7839, Val TN: 40837.0000, Val FP: 125.0000, Val FN: 130.0000, Val TP: 350.0000
[2025-05-07 18:01:34] [INFO] ✅ 新的最佳模型! MCC: 0.7299
[2025-05-07 20:00:57] [INFO] Epoch 7/30 - Train Loss: 0.2179, Val Loss: 0.0819, Val ACCURACY: 0.9872, Val PRECISION: 0.4721, Val RECALL: 0.8812, Val F1: 0.6148, Val MCC: 0.6398, Val AUC: 0.9922, Val PR_AUC: 0.7944, Val TN: 40489.0000, Val FP: 473.0000, Val FN: 57.0000, Val TP: 423.0000
[2025-05-07 22:00:16] [INFO] Epoch 8/30 - Train Loss: 0.2024, Val Loss: 0.0829, Val ACCURACY: 0.9883, Val PRECISION: 0.4970, Val RECALL: 0.8729, Val F1: 0.6334, Val MCC: 0.6538, Val AUC: 0.9928, Val PR_AUC: 0.8115, Val TN: 40538.0000, Val FP: 424.0000, Val FN: 61.0000, Val TP: 419.0000
[2025-05-07 23:59:50] [INFO] Epoch 9/30 - Train Loss: 0.1977, Val Loss: 0.1103, Val ACCURACY: 0.9918, Val PRECISION: 0.6081, Val RECALL: 0.8146, Val F1: 0.6963, Val MCC: 0.6999, Val AUC: 0.9919, Val PR_AUC: 0.7985, Val TN: 40710.0000, Val FP: 252.0000, Val FN: 89.0000, Val TP: 391.0000
[2025-05-08 01:59:23] [INFO] Epoch 10/30 - Train Loss: 0.1945, Val Loss: 0.0992, Val ACCURACY: 0.9922, Val PRECISION: 0.6240, Val RECALL: 0.8125, Val F1: 0.7059, Val MCC: 0.7083, Val AUC: 0.9911, Val PR_AUC: 0.8042, Val TN: 40727.0000, Val FP: 235.0000, Val FN: 90.0000, Val TP: 390.0000
[2025-05-08 03:58:49] [INFO] Epoch 11/30 - Train Loss: 0.1823, Val Loss: 0.0992, Val ACCURACY: 0.9881, Val PRECISION: 0.4913, Val RECALL: 0.8812, Val F1: 0.6309, Val MCC: 0.6530, Val AUC: 0.9915, Val PR_AUC: 0.7810, Val TN: 40524.0000, Val FP: 438.0000, Val FN: 57.0000, Val TP: 423.0000
[2025-05-08 05:58:10] [INFO] Epoch 12/30 - Train Loss: 0.1745, Val Loss: 0.0949, Val ACCURACY: 0.9892, Val PRECISION: 0.5204, Val RECALL: 0.8771, Val F1: 0.6532, Val MCC: 0.6710, Val AUC: 0.9912, Val PR_AUC: 0.8053, Val TN: 40574.0000, Val FP: 388.0000, Val FN: 59.0000, Val TP: 421.0000
[2025-05-08 07:57:24] [INFO] Epoch 13/30 - Train Loss: 0.1644, Val Loss: 0.0991, Val ACCURACY: 0.9926, Val PRECISION: 0.6416, Val RECALL: 0.8167, Val F1: 0.7186, Val MCC: 0.7203, Val AUC: 0.9890, Val PR_AUC: 0.8117, Val TN: 40743.0000, Val FP: 219.0000, Val FN: 88.0000, Val TP: 392.0000
[2025-05-08 09:56:49] [INFO] Epoch 14/30 - Train Loss: 0.1668, Val Loss: 0.0951, Val ACCURACY: 0.9905, Val PRECISION: 0.5572, Val RECALL: 0.8729, Val F1: 0.6802, Val MCC: 0.6932, Val AUC: 0.9909, Val PR_AUC: 0.8107, Val TN: 40629.0000, Val FP: 333.0000, Val FN: 61.0000, Val TP: 419.0000
[2025-05-08 11:56:52] [INFO] Epoch 15/30 - Train Loss: 0.1617, Val Loss: 0.0898, Val ACCURACY: 0.9916, Val PRECISION: 0.5942, Val RECALL: 0.8604, Val F1: 0.7030, Val MCC: 0.7112, Val AUC: 0.9907, Val PR_AUC: 0.8193, Val TN: 40680.0000, Val FP: 282.0000, Val FN: 67.0000, Val TP: 413.0000
[2025-05-08 13:56:26] [INFO] Epoch 16/30 - Train Loss: 0.1516, Val Loss: 0.1088, Val ACCURACY: 0.9927, Val PRECISION: 0.6483, Val RECALL: 0.8104, Val F1: 0.7204, Val MCC: 0.7213, Val AUC: 0.9908, Val PR_AUC: 0.8115, Val TN: 40751.0000, Val FP: 211.0000, Val FN: 91.0000, Val TP: 389.0000
[2025-05-08 13:56:26] [INFO] 早停触发! 10 轮没有改善.
[2025-05-08 14:03:24] [INFO] 
==================================================
开始训练第 5/5 折
==================================================
[2025-05-08 14:03:25] [INFO]   Fold 5 - 验证集 (不平衡): 41442 条 (阳性: 480, 阴性: 40962)
[2025-05-08 14:03:25] [INFO]   Fold 5 - 训练集池: 165770 条 (阳性: 1922, 阴性: 163848)
[2025-05-08 14:03:25] [INFO]   Fold 5 - 训练集 (平衡, 欠采样比例 1:20): 40362 条 (阳性: 1922, 阴性: 38440)
[2025-05-08 14:03:25] [INFO] 已创建默认融合模型，融合 ['esm2', 'esmc'] 模型特征
[2025-05-08 16:02:52] [INFO] Epoch 1/30 - Train Loss: 0.5415, Val Loss: 0.1045, Val ACCURACY: 0.9864, Val PRECISION: 0.4523, Val RECALL: 0.8104, Val F1: 0.5806, Val MCC: 0.5996, Val AUC: 0.9857, Val PR_AUC: 0.6927, Val TN: 40491.0000, Val FP: 471.0000, Val FN: 91.0000, Val TP: 389.0000
[2025-05-08 16:02:53] [INFO] ✅ 新的最佳模型! MCC: 0.5996
[2025-05-08 18:02:26] [INFO] Epoch 2/30 - Train Loss: 0.3784, Val Loss: 0.0875, Val ACCURACY: 0.9898, Val PRECISION: 0.5376, Val RECALL: 0.8479, Val F1: 0.6580, Val MCC: 0.6707, Val AUC: 0.9908, Val PR_AUC: 0.7660, Val TN: 40612.0000, Val FP: 350.0000, Val FN: 73.0000, Val TP: 407.0000
[2025-05-08 18:02:26] [INFO] ✅ 新的最佳模型! MCC: 0.6707
[2025-05-08 20:01:50] [INFO] Epoch 3/30 - Train Loss: 0.3201, Val Loss: 0.0893, Val ACCURACY: 0.9918, Val PRECISION: 0.6057, Val RECALL: 0.8417, Val F1: 0.7044, Val MCC: 0.7102, Val AUC: 0.9916, Val PR_AUC: 0.7826, Val TN: 40699.0000, Val FP: 263.0000, Val FN: 76.0000, Val TP: 404.0000
[2025-05-08 20:01:50] [INFO] ✅ 新的最佳模型! MCC: 0.7102
[2025-05-08 22:01:09] [INFO] Epoch 4/30 - Train Loss: 0.2934, Val Loss: 0.0874, Val ACCURACY: 0.9915, Val PRECISION: 0.5924, Val RECALL: 0.8417, Val F1: 0.6954, Val MCC: 0.7021, Val AUC: 0.9919, Val PR_AUC: 0.7824, Val TN: 40684.0000, Val FP: 278.0000, Val FN: 76.0000, Val TP: 404.0000
[2025-05-09 00:00:30] [INFO] Epoch 5/30 - Train Loss: 0.2584, Val Loss: 0.0739, Val ACCURACY: 0.9915, Val PRECISION: 0.5914, Val RECALL: 0.8562, Val F1: 0.6996, Val MCC: 0.7077, Val AUC: 0.9934, Val PR_AUC: 0.7941, Val TN: 40678.0000, Val FP: 284.0000, Val FN: 69.0000, Val TP: 411.0000
[2025-05-09 02:00:01] [INFO] Epoch 6/30 - Train Loss: 0.2377, Val Loss: 0.0840, Val ACCURACY: 0.9939, Val PRECISION: 0.7103, Val RECALL: 0.8021, Val F1: 0.7534, Val MCC: 0.7518, Val AUC: 0.9935, Val PR_AUC: 0.8038, Val TN: 40805.0000, Val FP: 157.0000, Val FN: 95.0000, Val TP: 385.0000
[2025-05-09 02:00:02] [INFO] ✅ 新的最佳模型! MCC: 0.7518
[2025-05-09 03:59:45] [INFO] Epoch 7/30 - Train Loss: 0.2261, Val Loss: 0.0995, Val ACCURACY: 0.9855, Val PRECISION: 0.4391, Val RECALL: 0.9021, Val F1: 0.5907, Val MCC: 0.6238, Val AUC: 0.9927, Val PR_AUC: 0.7854, Val TN: 40409.0000, Val FP: 553.0000, Val FN: 47.0000, Val TP: 433.0000
[2025-05-09 05:59:21] [INFO] Epoch 8/30 - Train Loss: 0.2093, Val Loss: 0.0916, Val ACCURACY: 0.9892, Val PRECISION: 0.5187, Val RECALL: 0.8958, Val F1: 0.6570, Val MCC: 0.6771, Val AUC: 0.9937, Val PR_AUC: 0.8098, Val TN: 40563.0000, Val FP: 399.0000, Val FN: 50.0000, Val TP: 430.0000
[2025-05-09 07:59:08] [INFO] Epoch 9/30 - Train Loss: 0.2027, Val Loss: 0.0816, Val ACCURACY: 0.9904, Val PRECISION: 0.5530, Val RECALL: 0.9021, Val F1: 0.6857, Val MCC: 0.7022, Val AUC: 0.9943, Val PR_AUC: 0.8141, Val TN: 40612.0000, Val FP: 350.0000, Val FN: 47.0000, Val TP: 433.0000
[2025-05-09 09:59:04] [INFO] Epoch 10/30 - Train Loss: 0.2003, Val Loss: 0.0888, Val ACCURACY: 0.9931, Val PRECISION: 0.6612, Val RECALL: 0.8333, Val F1: 0.7373, Val MCC: 0.7389, Val AUC: 0.9945, Val PR_AUC: 0.8109, Val TN: 40757.0000, Val FP: 205.0000, Val FN: 80.0000, Val TP: 400.0000
[2025-05-09 11:58:54] [INFO] Epoch 11/30 - Train Loss: 0.1824, Val Loss: 0.0746, Val ACCURACY: 0.9917, Val PRECISION: 0.5939, Val RECALL: 0.8896, Val F1: 0.7123, Val MCC: 0.7231, Val AUC: 0.9947, Val PR_AUC: 0.8131, Val TN: 40670.0000, Val FP: 292.0000, Val FN: 53.0000, Val TP: 427.0000
[2025-05-09 13:58:28] [INFO] Epoch 12/30 - Train Loss: 0.1834, Val Loss: 0.0822, Val ACCURACY: 0.9914, Val PRECISION: 0.5834, Val RECALL: 0.8958, Val F1: 0.7067, Val MCC: 0.7192, Val AUC: 0.9945, Val PR_AUC: 0.8095, Val TN: 40655.0000, Val FP: 307.0000, Val FN: 50.0000, Val TP: 430.0000
[2025-05-09 15:58:19] [INFO] Epoch 13/30 - Train Loss: 0.1772, Val Loss: 0.0820, Val ACCURACY: 0.9919, Val PRECISION: 0.6014, Val RECALL: 0.8833, Val F1: 0.7156, Val MCC: 0.7252, Val AUC: 0.9944, Val PR_AUC: 0.8078, Val TN: 40681.0000, Val FP: 281.0000, Val FN: 56.0000, Val TP: 424.0000
[2025-05-09 17:58:15] [INFO] Epoch 14/30 - Train Loss: 0.1645, Val Loss: 0.0781, Val ACCURACY: 0.9916, Val PRECISION: 0.5892, Val RECALL: 0.9083, Val F1: 0.7148, Val MCC: 0.7279, Val AUC: 0.9947, Val PR_AUC: 0.8164, Val TN: 40658.0000, Val FP: 304.0000, Val FN: 44.0000, Val TP: 436.0000
[2025-05-09 19:58:11] [INFO] Epoch 15/30 - Train Loss: 0.1580, Val Loss: 0.0875, Val ACCURACY: 0.9910, Val PRECISION: 0.5730, Val RECALL: 0.8917, Val F1: 0.6976, Val MCC: 0.7108, Val AUC: 0.9935, Val PR_AUC: 0.8102, Val TN: 40643.0000, Val FP: 319.0000, Val FN: 52.0000, Val TP: 428.0000
[2025-05-09 21:58:14] [INFO] Epoch 16/30 - Train Loss: 0.1452, Val Loss: 0.0866, Val ACCURACY: 0.9899, Val PRECISION: 0.5365, Val RECALL: 0.9187, Val F1: 0.6774, Val MCC: 0.6979, Val AUC: 0.9943, Val PR_AUC: 0.8042, Val TN: 40581.0000, Val FP: 381.0000, Val FN: 39.0000, Val TP: 441.0000
[2025-05-09 21:58:15] [INFO] 早停触发! 10 轮没有改善.
[2025-05-09 22:05:16] [INFO] 
==================================================
使用average集成方法进行测试集预测
==================================================
[2025-05-09 22:05:16] [INFO] 使用average集成方法进行预测...
[2025-05-09 22:05:16] [INFO] 加载第1折模型: ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_1_best_model.pt
⚠️ Warning: State dict mismatch for WeightedFusionClassifier at ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_1_best_model.pt. Attempting to load with strict=False. This might indicate an older checkpoint format. Layers like 'feature_encoder' or parts of 'head' might be re-initialized if they differ.
   Details: Error(s) in loading state_dict for WeightedFusionClassifier:
	Missing key(s) in state_dict: "feature_encoder.0.weight", "feature_encoder.0.bias", "feature_encoder.1.weight", "feature_encoder.1.bias", "feature_encoder.4.weight", "feature_encoder.4.bias", "feature_encoder.5.weight", "feature_encoder.5.bias", "head.0.weight", "head.0.bias", "head.1.weight", "head.1.bias", "head.4.weight", "head.4.bias". 
	Unexpected key(s) in state_dict: "fc1.weight", "fc1.bias", "fc2.weight", "fc2.bias". 
Successfully loaded state dict for WeightedFusionClassifier from ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_1_best_model.pt with strict=False.
[2025-05-09 22:12:15] [INFO] 加载第2折模型: ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_2_best_model.pt
⚠️ Warning: State dict mismatch for WeightedFusionClassifier at ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_2_best_model.pt. Attempting to load with strict=False. This might indicate an older checkpoint format. Layers like 'feature_encoder' or parts of 'head' might be re-initialized if they differ.
   Details: Error(s) in loading state_dict for WeightedFusionClassifier:
	Missing key(s) in state_dict: "feature_encoder.0.weight", "feature_encoder.0.bias", "feature_encoder.1.weight", "feature_encoder.1.bias", "feature_encoder.4.weight", "feature_encoder.4.bias", "feature_encoder.5.weight", "feature_encoder.5.bias", "head.0.weight", "head.0.bias", "head.1.weight", "head.1.bias", "head.4.weight", "head.4.bias". 
	Unexpected key(s) in state_dict: "fc1.weight", "fc1.bias", "fc2.weight", "fc2.bias". 
Successfully loaded state dict for WeightedFusionClassifier from ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_2_best_model.pt with strict=False.
[2025-05-09 22:19:14] [INFO] 加载第3折模型: ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_3_best_model.pt
⚠️ Warning: State dict mismatch for WeightedFusionClassifier at ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_3_best_model.pt. Attempting to load with strict=False. This might indicate an older checkpoint format. Layers like 'feature_encoder' or parts of 'head' might be re-initialized if they differ.
   Details: Error(s) in loading state_dict for WeightedFusionClassifier:
	Missing key(s) in state_dict: "feature_encoder.0.weight", "feature_encoder.0.bias", "feature_encoder.1.weight", "feature_encoder.1.bias", "feature_encoder.4.weight", "feature_encoder.4.bias", "feature_encoder.5.weight", "feature_encoder.5.bias", "head.0.weight", "head.0.bias", "head.1.weight", "head.1.bias", "head.4.weight", "head.4.bias". 
	Unexpected key(s) in state_dict: "fc1.weight", "fc1.bias", "fc2.weight", "fc2.bias". 
Successfully loaded state dict for WeightedFusionClassifier from ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_3_best_model.pt with strict=False.
[2025-05-09 22:26:13] [INFO] 加载第4折模型: ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_4_best_model.pt
⚠️ Warning: State dict mismatch for WeightedFusionClassifier at ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_4_best_model.pt. Attempting to load with strict=False. This might indicate an older checkpoint format. Layers like 'feature_encoder' or parts of 'head' might be re-initialized if they differ.
   Details: Error(s) in loading state_dict for WeightedFusionClassifier:
	Missing key(s) in state_dict: "feature_encoder.0.weight", "feature_encoder.0.bias", "feature_encoder.1.weight", "feature_encoder.1.bias", "feature_encoder.4.weight", "feature_encoder.4.bias", "feature_encoder.5.weight", "feature_encoder.5.bias", "head.0.weight", "head.0.bias", "head.1.weight", "head.1.bias", "head.4.weight", "head.4.bias". 
	Unexpected key(s) in state_dict: "fc1.weight", "fc1.bias", "fc2.weight", "fc2.bias". 
Successfully loaded state dict for WeightedFusionClassifier from ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_4_best_model.pt with strict=False.
[2025-05-09 22:33:12] [INFO] 加载第5折模型: ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_5_best_model.pt
⚠️ Warning: State dict mismatch for WeightedFusionClassifier at ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_5_best_model.pt. Attempting to load with strict=False. This might indicate an older checkpoint format. Layers like 'feature_encoder' or parts of 'head' might be re-initialized if they differ.
   Details: Error(s) in loading state_dict for WeightedFusionClassifier:
	Missing key(s) in state_dict: "feature_encoder.0.weight", "feature_encoder.0.bias", "feature_encoder.1.weight", "feature_encoder.1.bias", "feature_encoder.4.weight", "feature_encoder.4.bias", "feature_encoder.5.weight", "feature_encoder.5.bias", "head.0.weight", "head.0.bias", "head.1.weight", "head.1.bias", "head.4.weight", "head.4.bias". 
	Unexpected key(s) in state_dict: "fc1.weight", "fc1.bias", "fc2.weight", "fc2.bias". 
Successfully loaded state dict for WeightedFusionClassifier from ./train_12_3_3/ESMC+ESM2_20250501_222948/fold_5_best_model.pt with strict=False.
[2025-05-09 22:40:10] [INFO] 使用平均值集成：5个模型
[2025-05-09 22:40:10] [INFO] 
==================================================
[2025-05-09 22:40:10] [INFO] 集成模型测试集性能 (方法: average):
[2025-05-09 22:40:10] [INFO] accuracy: 0.8899
[2025-05-09 22:40:10] [INFO] precision: 0.1108
[2025-05-09 22:40:10] [INFO] recall: 0.2211
[2025-05-09 22:40:10] [INFO] f1: 0.1477
[2025-05-09 22:40:10] [INFO] mcc: 0.1022
[2025-05-09 22:40:10] [INFO] auc: 0.6946
[2025-05-09 22:40:10] [INFO] pr_auc: 0.0873
[2025-05-09 22:40:10] [INFO] tn: 4060.0000
[2025-05-09 22:40:10] [INFO] fp: 353.0000
[2025-05-09 22:40:10] [INFO] fn: 155.0000
[2025-05-09 22:40:10] [INFO] tp: 44.0000
[2025-05-09 22:40:10] [INFO] ==================================================

